<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selenium Practicals</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .main-container {
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #4a4a4a;
            font-size: 2.5em;
            margin-bottom: 30px;
        }
        .practical-container {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            overflow: hidden; /* To contain the button's position */
        }
        .header {
            padding: 15px 25px;
            background-color: #fafafa;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        h2 {
            font-size: 1.6em;
            color: #333;
            margin: 0;
        }
        .code-block {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            margin: 0;
            font-family: "Courier New", Courier, monospace;
            font-size: 0.95em;
            overflow-x: auto;
            white-space: pre;
        }
        .copy-button {
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        .copy-button:hover {
            background-color: #0056b3;
        }
        .copy-button:active {
            transform: scale(0.97);
        }
    </style>
</head>
<body>

    <div class="main-container">
        <h1>Selenium Automation Scripts</h1>

        <!-- Practical 3A -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 3A: Search and Verify Title on Wikipedia</h2>
                <button class="copy-button" onclick="copyCode('code-3a', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-3a">from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

driver = webdriver.Chrome()
try:
    driver.get("https://www.wikipedia.org/")
    print("Opened Wikipedia homepage.")

    search_box = driver.find_element(By.ID, "searchInput")
    search_box.send_keys("software testing")
    search_box.send_keys(Keys.RETURN)
    print("Searched for 'software testing'.")

    wait = WebDriverWait(driver, 10)
    expected_title = "Software testing - Wikipedia"
    wait.until(EC.title_is(expected_title))
    
    actual_title = driver.title
    print(f"Actual page title is: {actual_title}")

    if actual_title == expected_title:
        print("Title Verification: PASSED!")
    else:
        print(f"Title Verification: FAILED! Expected '{expected_title}'")

    heading_element = wait.until(EC.visibility_of_element_located((By.ID, "firstHeading")))
    print(f"Article Heading: {heading_element.text}")

finally:
    print("Closing browser in 5 seconds...")
    time.sleep(5)
    driver.quit()</code></pre>
        </div>

        <!-- Practical 3B -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 3B: Interact with a Dropdown Menu</h2>
                <button class="copy-button" onclick="copyCode('code-3b', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-3b">from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

driver = webdriver.Chrome()
try:
    driver.maximize_window()
    driver.get("https://the-internet.herokuapp.com/dropdown")

    wait = WebDriverWait(driver, 10)
    dropdown_locator = (By.ID, "dropdown")
    dropdown_element = wait.until(EC.presence_of_element_located(dropdown_locator))

    select = Select(dropdown_element)
    select.select_by_visible_text("Option 2")

    expected_option_text = "Option 2"
    selected_option_text = select.first_selected_option.text

    if selected_option_text == expected_option_text:
        print("‚úÖ Dropdown verification PASSED!")
    else:
        print("‚ùå Dropdown verification FAILED!")

finally:
    print("Test finished. Closing browser...")
    time.sleep(3)
    driver.quit()</code></pre>
        </div>

        <!-- Practical 4A -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 4A: Automate Login Process</h2>
                <button class="copy-button" onclick="copyCode('code-4a', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-4a">import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

driver = webdriver.Chrome()
try:
    driver.maximize_window()
    driver.get("https://the-internet.herokuapp.com/login")

    driver.find_element(By.ID, "username").send_keys("tomsmith")
    driver.find_element(By.ID, "password").send_keys("SuperSecretPassword!")
    driver.find_element(By.CSS_SELECTOR, "button[type='submit']").click()

    wait = WebDriverWait(driver, 10)
    expected_banner_text = "You logged into a secure area!"
    flash_banner = wait.until(EC.visibility_of_element_located((By.ID, "flash")))
    
    actual_banner_text = flash_banner.text
    assert expected_banner_text in actual_banner_text
    print("‚úÖ Assertion PASSED: Success banner text is correct!")

    logout_button = driver.find_element(By.CSS_SELECTOR, "a.button.secondary.radius")
    assert logout_button.is_displayed()
    print("‚úÖ Assertion PASSED: Logout button is displayed.")
    
    print("\nüéâ Login test completed successfully!")

except AssertionError:
    print("\n‚ùå Assertion FAILED: Login verification failed.")
except Exception as e:
    print(f"\nAn unexpected error occurred: {e}")
finally:
    print("Closing browser in 3 seconds...")
    time.sleep(3)
    driver.quit()</code></pre>
        </div>

        <!-- Practical 5 -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 5: Update Student Records from Excel</h2>
                <button class="copy-button" onclick="copyCode('code-5', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-5">import openpyxl
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.common.exceptions import NoSuchElementException

try:
    workbook = openpyxl.load_workbook("Untitled spreadsheet.xlsx")
    sheet = workbook.active
except FileNotFoundError:
    print("Error: 'Untitled spreadsheet.xlsx' not found. Make sure it's in the same folder as the script.")
    exit()

driver = webdriver.Chrome()

for row_num in range(2, sheet.max_row + 1):
    username = sheet.cell(row=row_num, column=1).value
    password = sheet.cell(row=row_num, column=2).value

    if not (username and password):
        print(f"Skipping row {row_num} due to missing data.")
        continue

    print(f"--- Processing Row {row_num}: User '{username}' ---")
    driver.get("https://the-internet.herokuapp.com/login")
    
    username_field = driver.find_element(By.ID, "username")
    password_field = driver.find_element(By.ID, "password")
    
    username_field.clear()
    username_field.send_keys(username)
    password_field.clear()
    password_field.send_keys(password)
    
    driver.find_element(By.CSS_SELECTOR, "button[type='submit']").click()
    time.sleep(2)

    try:
        driver.find_element(By.CSS_SELECTOR, "a.button.secondary.radius")
        print("‚úÖ Login Successful!")
        sheet.cell(row=row_num, column=3).value = "Passed"
    except NoSuchElementException:
        print("‚ùå Login Failed!")
        sheet.cell(row=row_num, column=3).value = "Failed"

try:
    workbook.save("Untitled spreadsheet_results.xlsx")
    print("\nTest complete. Results saved to 'Untitled spreadsheet_results.xlsx'.")
except PermissionError:
    print("\nError: Could not save the Excel file. Please ensure it is not open.")

input("Press Enter in the terminal to close the browser...")
driver.quit()</code></pre>
        </div>

        <!-- Practical 6A -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 6A: Analyze Student Scores in Excel</h2>
                <button class="copy-button" onclick="copyCode('code-6a', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-6a">import openpyxl

filename = "untitled spreadsheet.xlsx"
try:
    my_wb = openpyxl.load_workbook(filename)
    my_s = my_wb["Sheet1"]

    for r in range(2, my_s.max_row + 1):
        has_passed_one_subject = False
        for c in range(2, 5): # Assuming scores are in columns B, C, D
            score = my_s.cell(row=r, column=c).value
            if score is not None and str(score).isdigit() and int(score) > 60:
                has_passed_one_subject = True
                break
        
        if has_passed_one_subject:
            my_s.cell(row=r, column=5).value = "Pass" # Update status in column E
        else:
            my_s.cell(row=r, column=5).value = "Fail"

    my_wb.save(filename)
    print(f"‚úÖ Analysis complete. '{filename}' has been updated.")

except FileNotFoundError:
    print(f"‚ùå Error: Could not find the file '{filename}'")
except Exception as e:
    print(f"‚ùå An error occurred: {e}")</code></pre>
        </div>

        <!-- Practical 6B -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 6B: Verify Student Eligibility Online</h2>
                <button class="copy-button" onclick="copyCode('code-6b', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-6b">import openpyxl
from selenium import webdriver
from selenium.webdriver.common.by import By
import time

filename = "untitled spreadsheet.xlsx"
driver = None
try:
    my_wb = openpyxl.load_workbook(filename)
    my_s = my_wb["Sheet1"]

    print("Starting browser...")
    driver = webdriver.Firefox()
    driver.get("https://forms.gle/12345abcde") # Example Form URL
    time.sleep(2)

    for r in range(2, my_s.max_row + 1):
        student_is_eligible = False
        name = my_s.cell(row=r, column=1).value
        
        for c in range(2, 5): # Assuming scores are in columns B, C, D
            score = my_s.cell(row=r, column=c).value
            if score is not None and str(score).isdigit() and int(score) > 60:
                student_is_eligible = True
                break
        
        if student_is_eligible:
            print(f"‚úÖ Verifying '{name}' online...")
            # This is a placeholder for actual form interaction
            # For a real form, you would find elements and fill them:
            # name_field = driver.find_element(By.XPATH, '//*[...]/input')
            # name_field.send_keys(name)
            # driver.find_element(By.XPATH, '//*[...]/button').click()
            my_s.cell(row=r, column=5).value = "Verified Online"
            time.sleep(1)
        else:
            print(f"‚ùå '{name}' is not eligible for verification.")
            my_s.cell(row=r, column=5).value = "Not Eligible"

    my_wb.save(filename)
    print(f"\nAll done! '{filename}' has been updated with the results.")

except FileNotFoundError:
    print(f"‚ùå ERROR: '{filename}' was not found. Make sure it's in the same folder.")
except Exception as e:
    print(f"‚ùå An error occurred: {e}")
finally:
    if driver:
        print("Closing browser.")
        driver.quit()</code></pre>
        </div>

        <!-- Practical 7 -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 7: Count Web Page Objects</h2>
                <button class="copy-button" onclick="copyCode('code-7', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-7">from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager

driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))
driver.get("https://en.wikipedia.org/wiki/Amazon_(company)")

inputs = driver.find_elements(By.TAG_NAME, "input")
print(f"Total number of input elements: {len(inputs)}")

checkbox_count = 0
checked_checkboxes = 0
radio_count = 0
checked_radios = 0
text_count = 0
button_count = 0
other_inputs = 0

for element in inputs:
    input_type = element.get_attribute("type")
    if input_type == "checkbox":
        checkbox_count += 1
        if element.is_selected():
            checked_checkboxes += 1
    elif input_type == "radio":
        radio_count += 1
        if element.is_selected():
            checked_radios += 1
    elif input_type == "text":
        text_count += 1
    elif input_type == "button" or input_type == "submit" or input_type == "reset":
        button_count += 1
    else:
        other_inputs += 1

print(f"Total checkboxes: {checkbox_count}")
print(f"Checked checkboxes: {checked_checkboxes}")
print(f"Total radio buttons: {radio_count}")
print(f"Checked radio buttons: {checked_radios}")
print(f"Text inputs: {text_count}")
print(f"Buttons (Submit/Reset/etc): {button_count}")
print(f"Other input types: {other_inputs}")

driver.quit()</code></pre>
        </div>

        <!-- Practical 8 -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 8: Count Items in a Combo Box</h2>
                <button class="copy-button" onclick="copyCode('code-8', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-8">from selenium import webdriver
from selenium.webdriver.support.ui import Select
from selenium.webdriver.common.by import By
import time

# Note: This script requires a local HTML file with a combo box.
# Create a file named "ComboBox.html" with this content:
# &lt;select id="myComboBox"&gt;
#   &lt;option&gt;Option 1&lt;/option&gt;
#   &lt;option&gt;Option 2&lt;/option&gt;
#   &lt;option&gt;Option 3&lt;/option&gt;
# &lt;/select&gt;

driver = webdriver.Chrome()
try:
    # IMPORTANT: Update this path to where your ComboBox.html file is located
    driver.get("file:///C:/Users/anike/OneDrive/Desktop/New folder/ComboBox.html")
    time.sleep(2) # Wait for local file to load

    combobox_element = driver.find_element(By.ID, "myComboBox")
    print("‚úÖ Successfully found the combo box element.")

    select_object = Select(combobox_element)
    options = select_object.options
    
    print(f"Number of options: {len(options)}")
    for option in options:
        print(f"- {option.text}")

except Exception as e:
    print("‚ùå Error: Could not find the element or another issue occurred.")
    print(f"Details: {e}")

finally:
    print("Closing browser.")
    time.sleep(3)
    driver.quit()</code></pre>
        </div>

        <!-- Practical 9 -->
        <div class="practical-container">
            <div class="header">
                <h2>Practical 9: Count Checkboxes</h2>
                <button class="copy-button" onclick="copyCode('code-9', this)">Copy Code</button>
            </div>
            <pre class="code-block"><code id="code-9">from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager

driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))
driver.get("https://omayo.blogspot.com/")

checkboxes = driver.find_elements(By.XPATH, '//input[@type="checkbox"]')
print(f"Total checkboxes: {len(checkboxes)}")

checked_count = 0
for checkbox in checkboxes:
    if checkbox.is_selected():
        checked_count += 1

print(f"Number of checked checkboxes: {checked_count}")
# To get unchecked count, simply subtract checked from total
print(f"Number of unchecked checkboxes: {len(checkboxes) - checked_count}")

driver.quit()</code></pre>
        </div>

    </div>

    <script>
        function copyCode(elementId, buttonElement) {
            const codeElement = document.getElementById(elementId);
            const textToCopy = codeElement.innerText;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                // Success feedback
                const originalText = buttonElement.innerText;
                buttonElement.innerText = 'Copied! ‚úÖ';
                buttonElement.style.backgroundColor = '#28a745'; // Green color for success
                
                setTimeout(() => {
                    buttonElement.innerText = originalText;
                    buttonElement.style.backgroundColor = '#007bff'; // Revert to original blue color
                }, 2000); // Revert back after 2 seconds
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy text. Please try again.');
            });
        }
    </script>

</body>
</html>

